<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Pagamento - MultiCraft</title>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body{
      background:#0e0e0e;
      color:#fff;
      font-family:Arial, sans-serif;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      margin:0;
      padding:20px;
    }
    .card{
      background:#1c1c1c;
      padding:25px;
      border-radius:12px;
      width:100%;
      max-width:420px;
      text-align:center;
    }
    input,button{
      width:100%;
      padding:12px;
      border:none;
      border-radius:8px;
      margin-top:10px;
      font-size:16px;
    }
    button{
      background:#00ff88;
      font-weight:bold;
      cursor:pointer;
    }
    .line{
      background:#111;
      padding:10px;
      border-radius:8px;
      margin-top:10px;
      text-align:left;
    }
    .small{
      font-size:12px;
      color:#bbb;
      margin-top:10px;
    }
  </style>
</head>
<body>

<div class="card">
  <h2>ðŸ’³ Pagamento</h2>

  <div class="line"><b>ðŸ“¦ Kit:</b> <span id="kit">-</span></div>
  <div class="line"><b>ðŸ’° Valor:</b> R$ <span id="valor">-</span></div>

  <div class="line" style="text-align:center;">
    <div><b>ðŸ”‘ Chave PIX</b></div>
    <div style="font-size:18px;margin-top:6px;"><b>10099770164</b></div>
  </div>

  <input id="nick" placeholder="Nick no Minecraft" />

  <button onclick="confirmar()">JÃ¡ paguei</button>

  <div class="small">
    Aguarde a confirmaÃ§Ã£o de um staff para receber seus itens.
  </div>
</div>

<script>
  // âœ… Firebase (seu config)
  const firebaseConfig = {
    apiKey: "AIzaSyASk1w8w6YzIQhkbJh7xv5BJb8ZHmG7MxM",
    authDomain: "multicraft-ea978.firebaseapp.com",
    databaseURL: "https://multicraft-ea978-default-rtdb.firebaseio.com",
    projectId: "multicraft-ea978",
    storageBucket: "multicraft-ea978.firebasestorage.app",
    messagingSenderId: "587079793250",
    appId: "1:587079793250:web:21d3fb74ae55eb6f5eef3b"
  };

  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // âœ… Webhook PRIVADO (pendente)
  const webhookPendente = "https://discord.com/api/webhooks/1460447479563682012/ZwXCxogPkp2EBYQGE7--VVY9OFS7Ma7-APSRoVQFM0JbCrQu-ufUkfwTMRwdtiXoZo_G";

  // âœ… MantÃ©m igual (pega kit/valor do localStorage, como seu index faz)
  const kit = localStorage.getItem("kit") || "-";
  const valor = localStorage.getItem("valor") || "-";
  document.getElementById("kit").innerText = kit;
  document.getElementById("valor").innerText = valor;

  async function confirmar(){
    const nick = document.getElementById("nick").value.trim();

    if (!nick) {
      alert("Digite seu nick!");
      return;
    }
    if (kit === "-" || valor === "-") {
      alert("Volte para a loja e escolha um kit.");
      return;
    }

    // âœ… cria compra central no Firebase (aparece no seu admin em qualquer PC/celular)
    const id = db.ref("compras").push().key;

    const compra = {
      nick,
      kit,
      valor,
      status: "pendente",
      createdAt: Date.now()
    };

    await db.ref("compras/" + id).set(compra);

    // âœ… avisa no Discord privado
    fetch(webhookPendente, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        content:
          "ðŸŸ¡ **COMPRA PENDENTE**\n" +
          "ðŸ‘¤ Nick: " + nick + "\n" +
          "ðŸ“¦ Kit: " + kit + "\n" +
          "ðŸ’° Valor: R$" + valor + "\n" +
          "ðŸ†” ID: " + id
      })
    }).catch(()=>{});

    alert("Pagamento enviado! Aguarde a confirmaÃ§Ã£o de um staff.");
  }

  // deixa a funÃ§Ã£o global pro onclick
  window.confirmar = confirmar;
</script>

</body>
</html>
